<div class="title-feature text-left">
  <span>{{ 'text.finance' | translate }}</span>
</div>

<div class="container-fluid pt-4">
  <div class="row g-3 mb-4">
    <div class="col-12 col-sm-6 col-xl-3">
      <div class="card stat-card flex-row justify-content-left align-items-center border-0 shadow-sm p-3">
        <div class="icon-circle bg-info text-white me-4">
          <svg viewBox="0 0 24 24" width="24px" height="24px" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g opacity="0.4"> <path d="M9.5 13.7502C9.5 14.7202 10.25 15.5002 11.17 15.5002H13.05C13.85 15.5002 14.5 14.8202 14.5 13.9702C14.5 13.0602 14.1 12.7302 13.51 12.5202L10.5 11.4702C9.91 11.2602 9.51001 10.9402 9.51001 10.0202C9.51001 9.18023 10.16 8.49023 10.96 8.49023H12.84C13.76 8.49023 14.51 9.27023 14.51 10.2402" stroke="#ffffff" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path> <path d="M12 7.5V16.5" stroke="#ffffff" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path> </g> <path d="M22 12C22 17.52 17.52 22 12 22C6.48 22 2 17.52 2 12C2 6.48 6.48 2 12 2" stroke="#ffffff" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path> <path d="M17 3V7H21" stroke="#ffffff" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path> <path d="M22 2L17 7" stroke="#ffffff" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg>
        </div>
        <div>
          <h3 class="fw-bold mb-0" appCountUp [endValue]="balance" [duration]="2000">0</h3>
          <small class="text-secondary fw-semibold">Tổng số dư</small>
        </div>
      </div>
    </div>

    <div class="col-12 col-sm-6 col-xl-3">
      <div class="card stat-card flex-row justify-content-left align-items-center border-0 shadow-sm p-3">
        <div class="icon-circle bg-success text-white me-4">
          <svg viewBox="0 0 24 24" width="24px" height="24px" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g opacity="0.4"> <path d="M9.5 13.7502C9.5 14.7202 10.25 15.5002 11.17 15.5002H13.05C13.85 15.5002 14.5 14.8202 14.5 13.9702C14.5 13.0602 14.1 12.7302 13.51 12.5202L10.5 11.4702C9.91 11.2602 9.51001 10.9402 9.51001 10.0202C9.51001 9.18023 10.16 8.49023 10.96 8.49023H12.84C13.76 8.49023 14.51 9.27023 14.51 10.2402" stroke="#ffffff" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path> <path d="M12 7.5V16.5" stroke="#ffffff" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path> </g> <path d="M22 12C22 17.52 17.52 22 12 22C6.48 22 2 17.52 2 12C2 6.48 6.48 2 12 2" stroke="#ffffff" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path> <path d="M17 3V7H21" stroke="#ffffff" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path> <path d="M22 2L17 7" stroke="#ffffff" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg>
        </div>
        <div>
          <h3 class="fw-bold mb-0" appCountUp [endValue]="revenue" [duration]="2000">0</h3>
          <small class="text-secondary fw-semibold">Doanh thu</small>
        </div>
      </div>
    </div>

    <div class="col-12 col-sm-6 col-xl-3">
      <div class="card stat-card flex-row justify-content-left align-items-center border-0 shadow-sm p-3">
        <div class="icon-circle bg-warning text-white me-4">
          <svg viewBox="0 0 24 24" width="24px" height="24px" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M7.5 18C8.32843 18 9 18.6716 9 19.5C9 20.3284 8.32843 21 7.5 21C6.67157 21 6 20.3284 6 19.5C6 18.6716 6.67157 18 7.5 18Z" stroke="#ffffff" stroke-width="1.5"></path> <path d="M16.5 18.0001C17.3284 18.0001 18 18.6716 18 19.5001C18 20.3285 17.3284 21.0001 16.5 21.0001C15.6716 21.0001 15 20.3285 15 19.5001C15 18.6716 15.6716 18.0001 16.5 18.0001Z" stroke="#ffffff" stroke-width="1.5"></path> <path d="M2 3L2.26121 3.09184C3.5628 3.54945 4.2136 3.77826 4.58584 4.32298C4.95808 4.86771 4.95808 5.59126 4.95808 7.03836V9.76C4.95808 12.7016 5.02132 13.6723 5.88772 14.5862C6.75412 15.5 8.14857 15.5 10.9375 15.5H12M16.2404 15.5C17.8014 15.5 18.5819 15.5 19.1336 15.0504C19.6853 14.6008 19.8429 13.8364 20.158 12.3075L20.6578 9.88275C21.0049 8.14369 21.1784 7.27417 20.7345 6.69708C20.2906 6.12 18.7738 6.12 17.0888 6.12H11.0235M4.95808 6.12H7" stroke="#ffffff" stroke-width="1.5" stroke-linecap="round"></path> </g></svg>
        </div>
        <div>
          <h3 class="fw-bold mb-0" appCountUp [endValue]="profit" [duration]="2000">0</h3>
          <small class="text-secondary fw-semibold">Lợi nhuận</small>
        </div>
      </div>
    </div>

    <div class="col-12 col-sm-6 col-xl-3">
      <div class="card stat-card flex-row justify-content-left align-items-center border-0 shadow-sm p-3">
        <div class="icon-circle bg-danger text-white me-4">
          <svg viewBox="0 0 24 24" width="24px" height="24px" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g opacity="0.4"> <path d="M9.5 13.7502C9.5 14.7202 10.25 15.5002 11.17 15.5002H13.05C13.85 15.5002 14.5 14.8202 14.5 13.9702C14.5 13.0602 14.1 12.7302 13.51 12.5202L10.5 11.4702C9.91 11.2602 9.51001 10.9402 9.51001 10.0202C9.51001 9.18023 10.16 8.49023 10.96 8.49023H12.84C13.76 8.49023 14.51 9.27023 14.51 10.2402" stroke="#ffffff" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path> <path d="M12 7.5V16.5" stroke="#ffffff" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path> </g> <path d="M22 12C22 17.52 17.52 22 12 22C6.48 22 2 17.52 2 12C2 6.48 6.48 2 12 2" stroke="#ffffff" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path> <path d="M17 3V7H21" stroke="#ffffff" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path> <path d="M22 2L17 7" stroke="#ffffff" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg>
        </div>
        <div>
          <h3 class="fw-bold mb-0" appCountUp [endValue]="profit" [duration]="2000">0</h3>
          <small class="text-secondary fw-semibold">Phí sàn</small>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="field-search">
  <div class="search-criteria">
    <div class="item-search">
      <label for="search-role-keyword" class="fw-semibold">{{ 'global.keyword' | translate }}</label>
      <div class="input-text-custom">
        <input
          [(ngModel)]="financesFilter.keyword"
          name="keyword"
          class="form-control"
          type="search"
          id="search-role-keyword"
          [placeholder]="'Tìm mã giao dịch'"
          (keyup.enter)="onSearch()"
        />
      </div>
    </div>
    <button class="save-button-dialog ms-4" (click)="onSearch()" [disabled]="isLoading">
      <span [innerHTML]="ICON_SEARCH | safeHtml"></span>
      {{ 'global.search' | translate }}
    </button>
  </div>
</div>

<div class="tab-pane fade active show">
  <div class="row">
    <div class="col-xl-12">
      <div class="panel panel-inverse">
        <div class="table-responsive">
          <table class="table editing-table">
            <thead class="table-header-sticky">
            <tr class="table-custom-header">
              <th>{{ 'global.no' | translate }}</th>
              <th>{{ 'text.transactionCode' | translate }}</th>
              <th>{{ 'text.userSend' | translate }}</th>
              <th>{{ 'text.paymentType' | translate }}</th>
              <th>{{ 'text.paymentAmount' | translate }}</th>
              <th>{{ 'text.description' | translate }}</th>
              <th>{{ 'text.paymentStatus' | translate }}</th>
              <th>{{ 'text.paymentMethod' | translate }}</th>
              <th>{{ 'text.paymentTime' | translate }}</th>
            </tr>
            </thead>
            <tbody>
            <ng-container *ngFor="let paymentHistory of paymentHistories; index as i">
              <tr [ngClass]="{ 'odd-row': i % 2 === 1, 'even-row': i % 2 === 0 }" class="table-custom-body">
                <td class="text-center" (click)="view(paymentHistory.id)">{{ (financesFilter.page - 1) * financesFilter.size + i + 1 }}</td>
                <td class="break-word-table text-center" (click)="view(paymentHistory.id)">{{ paymentHistory.transId }}</td>
                <td class="break-word-table text-left td-text-overflow" (click)="view(paymentHistory.id)">
                  {{ paymentHistory.userId === 0 ? 'Hệ thống' : paymentHistory.username }}
                </td>
                <td class="break-word-table text-center" (click)="view(paymentHistory.id)">{{ PAYMENT_TYPE[paymentHistory.type] }}</td>
                <td class="break-word-table text-right" (click)="view(paymentHistory.id)">{{ paymentHistory.amount }}</td>
                <td class="break-word-table text-left td-text-overflow" (click)="view(paymentHistory.id)">{{ paymentHistory.description }}</td>
                <td class="break-word-table text-center" (click)="view(paymentHistory.id)">{{ PAYMENT_STATUS[paymentHistory.status] }}</td>
                <td class="break-word-table text-center" (click)="view(paymentHistory.id)">{{ PAYMENT_METHOD[paymentHistory.paymentMethod] }}</td>
                <td class="break-word-table text-center" (click)="view(paymentHistory.id)">{{ paymentHistory.paymentTime }}</td>
              </tr>
            </ng-container>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <div class="from-pagination">
    <div class="total">
      <span class="label-total">{{ 'global.total' | translate }}: {{ totalItems | number }}</span>
      <ng-select
        [items]="PAGINATION_PAGE_SIZE"
        [(ngModel)]="financesFilter.size"
        (ngModelChange)="getPaymentHistoriesWithPaging()"
      >
      </ng-select>
    </div>
    <ngb-pagination
      class="pagination"
      [collectionSize]="totalItems"
      [pageSize]="financesFilter.size"
      [(page)]="financesFilter.page"
      [directionLinks]="true"
      [maxSize]="5"
      (pageChange)="onChangedPage($event)"
    ></ngb-pagination>
  </div>
</div>
